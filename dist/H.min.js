!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.H=e()}(this,function(){"use strict";function t(t=300,e=150){const i=document.createElement("canvas");return i.setAttribute("width",String(t)),i.setAttribute("height",String(e)),i.style.cssText="position: absolute; top: 0; left: 0;",i}let e=1;var i={gen:()=>e++};return{Stage:class{constructor(e){this.forceRender=!1,this.objects=[];const i=e.el,s=+e.width||300,h=+e.height||150;this.container="string"==typeof i?document.querySelector(i):i,this.container.style.width=s+"px",this.container.style.height=h+"px",this.container.style.position="relative",this.width=s,this.height=h;const n=t(s,h);this.canvas=n,this.ctx=n.getContext("2d"),this.container.appendChild(n);const r=t(s,h);this.cacheCanvas=r,this.cacheCtx=r.getContext("2d"),requestAnimationFrame(this.loopAnim.bind(this))}loopAnim(){this.renderObjects(),requestAnimationFrame(this.loopAnim.bind(this))}renderObjects(){!this.forceRender&&this.objects.every(t=>!t.visible||!t.needUpdate())||(this.cacheCtx.clearRect(0,0,this.width,this.height),this.objects.forEach(t=>{t.visible&&t.render(this.cacheCtx)}),this.ctx.clearRect(0,0,this.width,this.height),this.ctx.drawImage(this.cacheCanvas,0,0),this.forceRender=!1)}add(){return this.objects.push(...arguments),this}remove(t){for(let e=0;e<this.objects.length;e++)if(this.objects[e].id===t){this.objects.splice(e,1),this.forceRender=!0;break}return this}},DisplayObject:class{constructor(t){return this.type="displayObject",this.updateList=["visible","left","top"],this.updateFlag=!1,this.visible=!0,this.left=0,this.top=0,this.id=i.gen(),this.proxy=new Proxy(this,{get:(t,e,i)=>Reflect.get(t,e,i),set:(t,e,i,s)=>(-1!==this.updateList.indexOf(String(e))&&(this.updateFlag=!0),Reflect.set(t,e,i,s))}),this.set(t),this.proxy}set(t){if("object"==typeof t)for(let e in t)t.hasOwnProperty(e)&&(this.proxy[e]=t[e])}needUpdate(){return this.updateFlag}render(t){this.updateFlag=!1}}}});
//# sourceMappingURL=H.min.js.map

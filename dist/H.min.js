!function (t, e) {
  "object" == typeof exports && "undefined" != typeof module ? module.exports = e(require("tslib")) : "function" == typeof define && define.amd ? define(["tslib"], e) : t.H = e(t.tslib_1)
}(this, function (t) {
  "use strict";

  function e(t, e) {
    void 0 === t && (t = 300), void 0 === e && (e = 150);
    var i = document.createElement("canvas");
    return i.setAttribute("width", String(t)), i.setAttribute("height", String(e)), i.style.cssText = "position: absolute; top: 0; left: 0;", i
  }

  var i = 1, n = {
    gen: function () {
      return i++
    }
  };
  return {
    Stage: function () {
      function i(t) {
        this.forceRender = !1, this.objects = [];
        var i = t.el, n = +t.width || 300, s = +t.height || 150;
        this.container = "string" == typeof i ? document.querySelector(i) : i, this.container.style.width = n + "px", this.container.style.height = s + "px", this.container.style.position = "relative", this.width = n, this.height = s;
        var r = e(n, s);
        this.canvas = r, this.ctx = r.getContext("2d"), this.container.appendChild(r);
        var o = e(n, s);
        this.cacheCanvas = o, this.cacheCtx = o.getContext("2d"), requestAnimationFrame(this.loopAnim.bind(this))
      }

      return i.prototype.loopAnim = function () {
        this.renderObjects(), requestAnimationFrame(this.loopAnim.bind(this))
      }, i.prototype.renderObjects = function () {
        var t = this;
        !this.forceRender && this.objects.every(function (t) {
          return !t.visible || !t.needUpdate()
        }) || (this.cacheCtx.clearRect(0, 0, this.width, this.height), this.objects.forEach(function (e) {
          e.visible && e.render(t.cacheCtx)
        }), this.ctx.clearRect(0, 0, this.width, this.height), this.ctx.drawImage(this.cacheCanvas, 0, 0), this.forceRender = !1)
      }, i.prototype.add = function () {
        var e;
        return (e = this.objects).push.apply(e, t.__spread(arguments)), this
      }, i.prototype.remove = function (t) {
        for (var e = 0; e < this.objects.length; e++) if (this.objects[e].id === t) {
          this.objects.splice(e, 1), this.forceRender = !0;
          break
        }
        return this
      }, i
    }(), DisplayObject: function () {
      function t(t) {
        var e = this;
        return this.type = "displayObject", this.updateList = ["visible", "left", "top"], this.updateFlag = !1, this.visible = !0, this.left = 0, this.top = 0, this.id = n.gen(), this.proxy = new Proxy(this, {
          get: function (t, e, i) {
            return Reflect.get(t, e, i)
          }, set: function (t, i, n, s) {
            return -1 !== e.updateList.indexOf(String(i)) && (e.updateFlag = !0), Reflect.set(t, i, n, s)
          }
        }), this.set(t), this.proxy
      }

      return t.prototype.set = function (t) {
        if ("object" == typeof t) for (var e in t) t.hasOwnProperty(e) && (this.proxy[e] = t[e])
      }, t.prototype.needUpdate = function () {
        return this.updateFlag
      }, t.prototype.render = function (t) {
        this.updateFlag = !1
      }, t
    }()
  }
});
//# sourceMappingURL=H.min.js.map
